<!-- BEGIN_TF_DOCS -->
## Requirements

| Name | Version |
|------|---------|
| <a name="requirement_azapi"></a> [azapi](#requirement\_azapi) | ~> 1.15 |
| <a name="requirement_validation"></a> [validation](#requirement\_validation) | ~> 1.1.1 |

## Providers

| Name | Version |
|------|---------|
| <a name="provider_azuread"></a> [azuread](#provider\_azuread) | n/a |
| <a name="provider_azurerm"></a> [azurerm](#provider\_azurerm) | n/a |
| <a name="provider_time"></a> [time](#provider\_time) | n/a |

## Modules

No modules.

## Resources

| Name | Type |
|------|------|
| [azurerm_pim_eligible_role_assignment.this](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/pim_eligible_role_assignment) | resource |
| [azurerm_role_management_policy.this](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/role_management_policy) | resource |
| [time_static.this](https://registry.terraform.io/providers/hashicorp/time/latest/docs/resources/static) | resource |
| [azuread_group.groups_by_display_name](https://registry.terraform.io/providers/hashicorp/azuread/latest/docs/data-sources/group) | data source |
| [azuread_group.groups_by_mail_nickname](https://registry.terraform.io/providers/hashicorp/azuread/latest/docs/data-sources/group) | data source |
| [azuread_group.groups_by_object_id](https://registry.terraform.io/providers/hashicorp/azuread/latest/docs/data-sources/group) | data source |
| [azuread_user.users_by_employee_id](https://registry.terraform.io/providers/hashicorp/azuread/latest/docs/data-sources/user) | data source |
| [azuread_user.users_by_mail](https://registry.terraform.io/providers/hashicorp/azuread/latest/docs/data-sources/user) | data source |
| [azuread_user.users_by_mail_nickname](https://registry.terraform.io/providers/hashicorp/azuread/latest/docs/data-sources/user) | data source |
| [azuread_user.users_by_object_id](https://registry.terraform.io/providers/hashicorp/azuread/latest/docs/data-sources/user) | data source |
| [azuread_user.users_by_user_principal_name](https://registry.terraform.io/providers/hashicorp/azuread/latest/docs/data-sources/user) | data source |
| [azurerm_client_config.current](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/data-sources/client_config) | data source |
| [azurerm_management_group.management_groups_by_id_or_display_name](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/data-sources/management_group) | data source |
| [azurerm_role_definition.role_definitions_by_name](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/data-sources/role_definition) | data source |

## Inputs

| Name | Description | Type | Default | Required |
|------|-------------|------|---------|:--------:|
| <a name="input_groups_by_display_name"></a> [groups\_by\_display\_name](#input\_groups\_by\_display\_name) | (Optional) A map of Entra ID groups to reference in role assignments.<br>The key is something unique to you. The value is the display name of the group.<br><br>Example Input:<pre>hcl<br>groups_by_display_name = {<br>  my-group-1 = "My Group 1"<br>  my-group-2 = "My Group 2"<br>}</pre> | `map(string)` | `{}` | no |
| <a name="input_groups_by_mail_nickname"></a> [groups\_by\_mail\_nickname](#input\_groups\_by\_mail\_nickname) | (Optional) A map of Entra ID groups to reference in role assignments.<br>The key is something unique to you. The value is the mail nickname of the group.<br><br>Example Input:<pre>hcl<br>groups_by_mail_nickname = {<br>  my-group-1 = "my-group-1-nickname"<br>  my-group-2 = "my-group-2-nickname"<br>}</pre> | `map(string)` | `{}` | no |
| <a name="input_groups_by_object_id"></a> [groups\_by\_object\_id](#input\_groups\_by\_object\_id) | (Optional) A map of Entra ID groups to reference in role assignments.<br>The key is something unique to you. The value is the object ID of the group.<br><br>Example Input:<pre>hcl<br>groups_by_object_id = {<br>  my-group-1 = "00000000-0000-0000-0000-000000000001"<br>  my-group-2 = "00000000-0000-0000-0000-000000000002"<br>}</pre> | `map(string)` | `{}` | no |
| <a name="input_role_assignments_for_management_groups"></a> [role\_assignments\_for\_management\_groups](#input\_role\_assignments\_for\_management\_groups) | (Optional) Role assignments to be applied to management groups.<br>This is a convenience variable that avoids the need to find the resource id of the management group.<br><br>- management\_group\_id: (Optional) The id of the management group (one of `management_group_id` or `management_group_display_name` must be supplied).<br>- management\_group\_display\_name: (Optional) The display name of the management group.<br>- role\_assignments: (Required) The role assignments to be applied to the scope.<br>  - role\_definition: (Required) The key of the role definition as defined in the `role_definitions` variable.<br>  - users: (Optional) The keys of the users as defined in one of the `users_by_...` variables.<br>  - groups: (Optional) The keys of the groups as defined in one of the `groups_by_...` variables.<br>  - app\_registrations: (Optional) The keys of the app registrations as defined in one of the `app_registrations_by_...` variables.<br>  - system\_assigned\_managed\_identities: (Optional) The keys of the system assigned managed identities as defined in one of the `system_assigned_managed_identities_by_...` variables.<br>  - user\_assigned\_managed\_identities: (Optional) The keys of the user assigned managed identities as defined in one of the `user_assigned_managed_identities_by_...` variables.<br>  - any\_principals: (Optional) The keys of the principals as defined in any of the `[principal_type]_by_...` variables. This is a convenience method that can be used in combination with or instrad of the specific principal type options.<br><br>Example Input:<pre>hcl<br>role_assignments_for_management_groups = {<br>  management_group_id = "mg-1-id"<br>  role_assignments    = {<br>    role_definition = "contributor"<br>    users = [<br>      "my-user-1",<br>      "my-user-2"<br>    ]<br>    groups = [<br>      "my-group-1",<br>      "my-group-2"<br>    ]<br>    app_registrations = [<br>      "my-app-1",<br>      "my-app-2"<br>    ]<br>    system_assigned_managed_identities = [<br>      "my-vm-1",<br>      "my-vm-2"<br>    ]<br>    user_assigned_managed_identities = [<br>      "my-user-assigned-managed-identity-1",<br>      "my-user-assigned-managed-identity-2"<br>    ]<br>  }<br>}<br><br>role_assignments_for_management_groups = {<br>  management_group_display_name = "mg-1-display-name"<br>  role_assignments              = {<br>    role_definition = "contributor"<br>    users = [<br>      "my-user-1",<br>      "my-user-2"<br>    ]<br>    groups = [<br>      "my-group-1",<br>      "my-group-2"<br>    ]<br>    app_registrations = [<br>      "my-app-1",<br>      "my-app-2"<br>    ]<br>    system_assigned_managed_identities = [<br>      "my-vm-1",<br>      "my-vm-2"<br>    ]<br>    user_assigned_managed_identities = [<br>      "my-user-assigned-managed-identity-1",<br>      "my-user-assigned-managed-identity-2"<br>    ]<br>  }<br>}</pre> | <pre>map(object({<br>    management_group_id           = optional(string, null)<br>    management_group_display_name = optional(string, null)<br>    role_assignments = map(object({<br>      role_definition                    = string<br>      users                              = optional(set(string), [])<br>      groups                             = optional(set(string), [])<br>      app_registrations                  = optional(set(string), [])<br>      system_assigned_managed_identities = optional(set(string), [])<br>      user_assigned_managed_identities   = optional(set(string), [])<br>      any_principals                     = optional(set(string), [])<br>      expiration_days                    = optional(number, 180)<br>    }))<br>  }))</pre> | `{}` | no |
| <a name="input_role_assignments_for_resource_groups"></a> [role\_assignments\_for\_resource\_groups](#input\_role\_assignments\_for\_resource\_groups) | (Optional) Role assignments to be applied to resource groups.<br>The resource group can be in the current subscription (default) or a `subscription_id` can be supplied to target a resource group in another subscription.<br>This is a convenience variable that avoids the need to find the resource id of the resource group.<br><br>- resource\_group\_name: (Required) The name of the resource group.<br>- subscription\_id: (Optional) The id of the subscription. If not supplied the current subscription is used.<br>- role\_assignments: (Required) The role assignments to be applied to the scope.<br>  - role\_definition: (Required) The key of the role definition as defined in the `role_definitions` variable.<br>  - users: (Optional) The keys of the users as defined in one of the `users_by_...` variables.<br>  - groups: (Optional) The keys of the groups as defined in one of the `groups_by_...` variables.<br>  - app\_registrations: (Optional) The keys of the app registrations as defined in one of the `app_registrations_by_...` variables.<br>  - system\_assigned\_managed\_identities: (Optional) The keys of the system assigned managed identities as defined in one of the `system_assigned_managed_identities_by_...` variables.<br>  - user\_assigned\_managed\_identities: (Optional) The keys of the user assigned managed identities as defined in one of the `user_assigned_managed_identities_by_...` variables.<br>  - any\_principals: (Optional) The keys of the principals as defined in any of the `[principal_type]_by_...` variables. This is a convenience method that can be used in combination with or instrad of the specific principal type options.<br><br>Example Input:<pre>hcl<br>role_assignments_for_resource_groups = {<br>  resource_group_name = "my-resource-group-name"<br>  role_assignments    = {<br>    role_definition = "contributor"<br>    users = [<br>      "my-user-1",<br>      "my-user-2"<br>    ]<br>    groups = [<br>      "my-group-1",<br>      "my-group-2"<br>    ]<br>    app_registrations = [<br>      "my-app-1",<br>      "my-app-2"<br>    ]<br>    system_assigned_managed_identities = [<br>      "my-vm-1",<br>      "my-vm-2"<br>    ]<br>    user_assigned_managed_identities = [<br>      "my-user-assigned-managed-identity-1",<br>      "my-user-assigned-managed-identity-2"<br>    ]<br>  }<br>}</pre> | <pre>map(object({<br>    resource_group_name = string<br>    subscription_id     = optional(string, null)<br>    role_assignments = map(object({<br>      role_definition                    = string<br>      users                              = optional(set(string), [])<br>      groups                             = optional(set(string), [])<br>      app_registrations                  = optional(set(string), [])<br>      system_assigned_managed_identities = optional(set(string), [])<br>      user_assigned_managed_identities   = optional(set(string), [])<br>      any_principals                     = optional(set(string), [])<br>      expiration_days                    = optional(number, 180)<br>    }))<br>  }))</pre> | `{}` | no |
| <a name="input_role_assignments_for_scopes"></a> [role\_assignments\_for\_scopes](#input\_role\_assignments\_for\_scopes) | (Optional) Role assignments to be applied to specific scope ids. The scope id is the id of the resource, resource group, subscription or management group.<br><br>- scope: (Required) The scope / id of the resource, resource group, subscription or management group.<br>- role\_assignments: (Required) The role assignments to be applied to the scope.<br>  - role\_definition: (Required) The key of the role definition as defined in the `role_definitions` variable.<br>  - users: (Optional) The keys of the users as defined in one of the `users_by_...` variables.<br>  - groups: (Optional) The keys of the groups as defined in one of the `groups_by_...` variables.<br>  - app\_registrations: (Optional) The keys of the app registrations as defined in one of the `app_registrations_by_...` variables.<br>  - system\_assigned\_managed\_identities: (Optional) The keys of the system assigned managed identities as defined in one of the `system_assigned_managed_identities_by_...` variables.<br>  - user\_assigned\_managed\_identities: (Optional) The keys of the user assigned managed identities as defined in one of the `user_assigned_managed_identities_by_...` variables.<br>  - any\_principals: (Optional) The keys of the principals as defined in any of the `[principal_type]_by_...` variables. This is a convenience method that can be used in combination with or instrad of the specific principal type options.<br><br>Example Input:<pre>hcl<br>role_assignments_for_scopes = {<br>  scope            = "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/my-resource-group"<br>  role_assignments = {<br>    role_definition = "contributor"<br>    users = [<br>      "my-user-1",<br>      "my-user-2"<br>    ]<br>    groups = [<br>      "my-group-1",<br>      "my-group-2"<br>    ]<br>    app_registrations = [<br>      "my-app-1",<br>      "my-app-2"<br>    ]<br>    system_assigned_managed_identities = [<br>      "my-vm-1",<br>      "my-vm-2"<br>    ]<br>    user_assigned_managed_identities = [<br>      "my-user-assigned-managed-identity-1",<br>      "my-user-assigned-managed-identity-2"<br>    ]<br>  }<br>}</pre> | <pre>map(object({<br>    scope = string<br>    role_assignments = map(object({<br>      role_definition                    = string<br>      users                              = optional(set(string), [])<br>      groups                             = optional(set(string), [])<br>      app_registrations                  = optional(set(string), [])<br>      system_assigned_managed_identities = optional(set(string), [])<br>      user_assigned_managed_identities   = optional(set(string), [])<br>      any_principals                     = optional(set(string), [])<br>      expiration_days                    = optional(number, 180)<br>    }))<br>  }))</pre> | `{}` | no |
| <a name="input_role_assignments_for_subscriptions"></a> [role\_assignments\_for\_subscriptions](#input\_role\_assignments\_for\_subscriptions) | (Optional) Role assignments to be applied to subscriptions.<br>This will default to the current subscription (default) or a `subscription_id` can be supplied to target another subscription.<br>This is a convenience variable that avoids the need to find the resource id of the subscription.<br><br>- subscription\_id: (Optional) The id of the subscription. If not supplied the current subscription is used.<br>- role\_assignments: (Required) The role assignments to be applied to the scope.<br>  - role\_definition: (Required) The key of the role definition as defined in the `role_definitions` variable.<br>  - users: (Optional) The keys of the users as defined in one of the `users_by_...` variables.<br>  - groups: (Optional) The keys of the groups as defined in one of the `groups_by_...` variables.<br>  - app\_registrations: (Optional) The keys of the app registrations as defined in one of the `app_registrations_by_...` variables.<br>  - system\_assigned\_managed\_identities: (Optional) The keys of the system assigned managed identities as defined in one of the `system_assigned_managed_identities_by_...` variables.<br>  - user\_assigned\_managed\_identities: (Optional) The keys of the user assigned managed identities as defined in one of the `user_assigned_managed_identities_by_...` variables.<br>  - any\_principals: (Optional) The keys of the principals as defined in any of the `[principal_type]_by_...` variables. This is a convenience method that can be used in combination with or instrad of the specific principal type options.<br><br>Example Input:<pre>hcl<br>role_assignments_for_subscriptions = {<br>  subscription_id     = "00000000-0000-0000-0000-000000000000"<br>  role_assignments    = {<br>    role_definition = "contributor"<br>    users = [<br>      "my-user-1",<br>      "my-user-2"<br>    ]<br>    groups = [<br>      "my-group-1",<br>      "my-group-2"<br>    ]<br>    app_registrations = [<br>      "my-app-1",<br>      "my-app-2"<br>    ]<br>    system_assigned_managed_identities = [<br>      "my-vm-1",<br>      "my-vm-2"<br>    ]<br>    user_assigned_managed_identities = [<br>      "my-user-assigned-managed-identity-1",<br>      "my-user-assigned-managed-identity-2"<br>    ]<br>  }<br>}</pre> | <pre>map(object({<br>    subscription_id = optional(string, null)<br>    role_assignments = map(object({<br>      role_definition                    = string<br>      users                              = optional(set(string), [])<br>      groups                             = optional(set(string), [])<br>      app_registrations                  = optional(set(string), [])<br>      system_assigned_managed_identities = optional(set(string), [])<br>      user_assigned_managed_identities   = optional(set(string), [])<br>      any_principals                     = optional(set(string), [])<br>      expiration_days                    = optional(number, 180)<br>    }))<br>  }))</pre> | `{}` | no |
| <a name="input_role_definitions"></a> [role\_definitions](#input\_role\_definitions) | (Optional) A map of Azure Resource Manager role definitions to reference in role assignments.<br>The key is something unique to you. The value is a built in or custom role definition name.<br>Additionally we include the attributes for the optional PIM rules.<br><br>Example Input:<pre>hcl<br>role_definitions = {<br>  owner = {<br>    name = "Owner"<br>  }<br>  contributor = {<br>    name = "Contributor"<br>    require_approval = true<br>    approvers = {<br>      primary_approver = {<br>        object_id = "00000000-0000-0000-0000-000000000000"<br>        type      = "User"<br>      }<br>    }<br>  }<br>  reader = {<br>    name = "Reader"<br>    multi_factor_authentication = true<br>  }<br>  custom_role_by_name = {<br>    name  = "Custom Role"<br>    scope = "/subscriptions/00000000-0000-0000-0000-000000000000"<br>    requires_ticket_info = true<br>  }<br>  custom_role_by_id = {<br>    id = "00000000-0000-0000-0000-000000000000"<br>  }<br>}</pre> | <pre>map(object({<br>    id                                 = optional(string)<br>    name                               = optional(string)<br>    scope                              = optional(string)<br>    require_multifactor_authentication = optional(bool, false)<br>    require_approval                   = optional(bool, false)<br>    require_ticket_info                = optional(bool, false)<br>    approvers = optional(map(object({<br>      object_id = optional(string)<br>      type      = optional(string)<br>    })), {})<br>    additional_approver_recipients = optional(list(string), [])<br>    additional_assignee_recipients = optional(list(string), [])<br>    additional_admin_recipients    = optional(list(string), [])<br>  }))</pre> | `{}` | no |
| <a name="input_users_by_employee_id"></a> [users\_by\_employee\_id](#input\_users\_by\_employee\_id) | (Optional) A map of Entra ID users to reference in role assignments.<br>The key is something unique to you. The value is the employee ID of the user.<br><br>Example Input:<pre>hcl<br>users_by_employee_id = {<br>  my-user-1 = "1234567890"<br>  my-user-2 = "0987654321"<br>}</pre> | `map(string)` | `{}` | no |
| <a name="input_users_by_mail"></a> [users\_by\_mail](#input\_users\_by\_mail) | (Optional) A map of Entra ID users to reference in role assignments.<br>The key is something unique to you. The value is the mail address of the user.<br><br>Example Input:<pre>hcl<br>users_by_mail = {<br>  my-user-1 = "user.1@example.com"<br>  my-user-2 = "user.2@example.com"<br>}</pre> | `map(string)` | `{}` | no |
| <a name="input_users_by_mail_nickname"></a> [users\_by\_mail\_nickname](#input\_users\_by\_mail\_nickname) | (Optional) A map of Entra ID users to reference in role assignments.<br>The key is something unique to you. The value is the mail nickname of the user.<br><br>Example Input:<pre>hcl<br>users_by_mail_nickname = {<br>  my-user-1 = "user1-nickname"<br>  my-user-2 = "user2-nickname"<br>}</pre> | `map(string)` | `{}` | no |
| <a name="input_users_by_object_id"></a> [users\_by\_object\_id](#input\_users\_by\_object\_id) | (Optional) A map of Entra ID users to reference in role assignments.<br>The key is something unique to you. The value is the object ID of the user.<br><br>Example Input:<pre>hcl<br>users_by_object_id = {<br>  my-user-1 = "00000000-0000-0000-0000-000000000001"<br>  my-user-2 = "00000000-0000-0000-0000-000000000002"<br>}</pre> | `map(string)` | `{}` | no |
| <a name="input_users_by_user_principal_name"></a> [users\_by\_user\_principal\_name](#input\_users\_by\_user\_principal\_name) | (Optional) A map of Entra ID users to reference in role assignments.<br>The key is something unique to you. The value is the user principal name (UPN) of the user.<br><br>Example Input:<pre>hcl<br>users_by_user_principal_name = {<br>  my-user-1 = "user1@example.com"<br>  my-user-2 = "user2@example.com"<br>}</pre> | `map(string)` | `{}` | no |

## Outputs

No outputs.
<!-- END_TF_DOCS -->